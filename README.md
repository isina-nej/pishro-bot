# ๐ค Pishro Bot - ุฑุจุงุชู ูุฏุฑุช ุณุฑูุงูโฺฏุฐุงุฑ

ุณุณุชู ุฌุงูุน ูุฏุฑุช ุณุฑูุงูโฺฏุฐุงุฑ ุจุง ุฑุจุงุช ุชูฺฏุฑุงู ุญุฑููโุงุ ุฏุงุดุจูุฑุฏ ูุจุ ู Webhook Support.

## โญ **ูฺฺฏโูุง ุงุตู**

### ๐ฏ **ูุฏุฑุช ุณุฑูุงูโฺฏุฐุงุฑ**
- โ ุงุฌุงุฏ ู ุฑุฏุงุจ ุณุฑูุงูโฺฏุฐุงุฑโูุง (Investment)
- โ ุซุจุช ุชุฑุงฺฉูุดโูุง ูุงู (Transaction)
- โ ูุญุงุณุจูู ุฎูุฏฺฉุงุฑ ุจุงุฒุฏู (Valuation)
- โ ููุชุฑ ู ุฌุณุชุฌู ูพุดุฑูุชูู
- โ ฺฏุฒุงุฑุดโูุง ุชูุตู

### ๐ฅ **ุณุณุชู ููุดโูุง**
- **Admin**: ุฏุณุชุฑุณ ฺฉุงูู + ูุฏุฑุช ฺฉุงุฑุจุฑุงู
- **Investor** (ุณุฑูุงูโฺฏุฐุงุฑ): ูุดุงูุฏูู ุณุฑูุงูโฺฏุฐุงุฑโูุง ุฎูุฏ  
- **Accountant** (ุญุณุงุจุฏุงุฑ): ูุฏุฑุช ุชุฑุงฺฉูุดโูุง ู ฺฏุฒุงุฑุดโูุง

### ๐จ **ุฑุงุจุท ฺฉุงุฑุจุฑ ูพุดุฑูุชูู (Glass Panel)**
- Glass Panel Design ุจุง ุตูุญูโฺฉูุฏูุง ููุดููุฏ
- Quick Actions ุจุฑุง ุนููุงุช ุดุงุน
- Dashboard ุขููุงู ุจุฑุง ูุธุงุฑุช Real-Time
- Terminal Dashboard ุจุฑุง ุฎุท ูุฑูุงู

### โ๏ธ **ุชูุธูุงุช ฺฉุงุฑุจุฑ ุฌุงูุน**
- ููุชูฺฉุดูโูุง ุดุฎุตโุณุงุฒโุดุฏู
- ุงููุช (ุชุบุฑ ุฑูุฒุ ุชุงุฏ ุฏู ูุฑุญููโุง)
- ุญุฑูโุฎุตูุต ู ุชูุธูุงุช ููุงุด
- ฺฏุฒููู ุฒุจุงู (ูุงุฑุณ/ุงูฺฏูุณ) ู ููุทููู ุฒูุงู

### ๐ **Infrastructure ูพุดุฑูุชูู**
- **Webhook Server** (FastAPI) ุจุฑุง Production
- **Ngrok Integration** ุจุฑุง Public Access
- **Web Dashboard** ุจุง Logs Real-Time
- **Terminal Dashboard** ุจุฑุง Quick Access

## ๐ **ูููโููุงู ุณุฑุน**

### **ฺฏุฒููู 1: ุชููุง ุฑุจุงุช (Simple)**
```bash
bash start_bot.sh
# ุง
python3 run_bot.py
```

### **ฺฏุฒููู 2: ุฑุจุงุช + ุฏุงุดุจูุฑุฏ ูุจ (Recommended) โญ**
```bash
bash run_servers.sh
# ุงูุชุฎุงุจ ฺฏุฒููู 2

# ุณูพุณ ูุฑูุฑฺฏุฑ: http://localhost:8000
```

### **ฺฏุฒููู 3: ุฑุจุงุช + Webhook + Ngrok (Production)**
```bash
bash setup_webhook_ngrok.sh
# ุฎุฑูุฌ: https://xxxx-xx-xxx-xxx.ngrok.io
```

### **ฺฏุฒููู 4: ูุดุงูุฏูู ูุงฺฏโูุง ู ูุถุนุช**
```bash
bash dashboard.sh
```

## ๐ **ูพุดโูุงุฒูุง**

- Python 3.10+
- pip ุง Poetry
- Telegram Bot Token
- SQLite (ุฏุฑ ุฏุฑุจุงูุชโูุง ููุฌูุฏ)

## ๐ **ูุตุจ (ฺฉ ุจุงุฑ)**

```bash
# 1. ูุนูุณุงุฒ ูุญุท ูุฌุงุฒ
source venv/bin/activate

# 2. ูุตุจ ูุงุฒููุฏโูุง
pip install -r requirements-sqlite.txt

# 3. ุชูุธู .env
# BOT_TOKEN ุฎูุฏ ุฑุง ูุงุฑุฏ ฺฉูุฏ

# 4. ุดุฑูุน
bash start_bot.sh
```

## ๏ฟฝ **ุณุงุฎุชุงุฑ ูพุฑูฺู**

```
pishro-bot/
โโโ ๐ Scripts
โ   โโโ run_bot.py                 # ููุทูู ุดุฑูุน ุงุตู ุฑุจุงุช
โ   โโโ webhook_server.py          # FastAPI Server
โ   โโโ run_servers.sh             # ูุฏุฑ ุณุฑูุฑโูุง (IPA)
โ   โโโ start_bot.sh               # ุดุฑูุน ุฑุจุงุช
โ   โโโ stop_bot.sh                # ูุชููู ุฑุจุงุช
โ   โโโ setup_webhook_ngrok.sh     # Webhook + Ngrok
โ   โโโ dashboard.sh               # ุฏุงุดุจูุฑุฏ ุชุฑููุงู
โ   โโโ add_admin.py               # ุงุถุงููู ุงุฏูู
โ
โโโ ๐ app/
โ   โโโ bot.py                     # ูพฺฉุฑุจูุฏ ุฑุจุงุช
โ   โโโ handlers/
โ   โ   โโโ auth.py                # ุงุญุฑุงุฒ ููุช + ุดุฑูุน
โ   โ   โโโ settings.py            # ุชูุธูุงุช ฺฉุงุฑุจุฑ
โ   โ   โโโ investor.py            # ุนููุงุช ุณุฑูุงูโฺฏุฐุงุฑ
โ   โ   โโโ accountant.py          # ุนููุงุช ุญุณุงุจุฏุงุฑ
โ   โ   โโโ admin.py               # ุนููุงุช ุงุฏูู
โ   โโโ keyboards/
โ   โ   โโโ advanced.py            # Glass Panel Design
โ   โ   โโโ ...
โ   โโโ database/
โ   โ   โโโ session.py             # ุงุชุตุงู ุฏุชุงุจุณ
โ   โ   โโโ init_db.py             # ุชููโฺฉุฑุฏู ุฏุชุงุจุณ
โ   โโโ models/
โ   โ   โโโ models.py              # ORM Models (4 ูุฏู)
โ   โโโ services/
โ       โโโ repositories.py        # ููุทููู ฺฉุณุจโูโฺฉุงุฑ
โ
โโโ ๐ Database
โ   โโโ pishro_bot.db              # SQLite Database
โ
โโโ ๐ Config
โ   โโโ .env                       # ุชูุธูุงุช ูุญุท
โ   โโโ requirements-sqlite.txt    # ูุงุจุณุชฺฏโูุง
โ   โโโ README.md                  # ุงู ูุงู
โ   โโโ WEBHOOK_GUIDE.md           # ุฑุงูููุง Webhook
โ
โโโ ๐ Logs
    โโโ bot.log                    # ูุงฺฏโูุง ุฑุจุงุช
    โโโ webhook.log                # ูุงฺฏโูุง Webhook
    โโโ ngrok.log                  # ูุงฺฏโูุง Ngrok
```

## ๐ **ูุชุบุฑูุง ูุญุท (.env)**

```env
# ุงูุฒุงู
BOT_TOKEN=your_telegram_bot_token_here

# ูพุงฺฏุงูู ุฏุงุฏู
DATABASE_URL=sqlite:///pishro_bot.db

# IDโูุง ุงุฏูู (ฺฉุงูุงโุฌุฏุง)
ADMIN_IDS=1399836576

# ุณุทุญ ูุงฺฏ
LOG_LEVEL=INFO

# ุชูุธูุงุช Webhook (ุงุฎุชุงุฑ)
WEBHOOK_HOST=https://your-domain.com
WEBHOOK_PORT=8000
WEBHOOK_PATH=/webhook/telegram
```

## ๐ฎ **ุฑุงูููุง ฺฉุงุฑุจุฑ**

### **ุจุฑุง ุณุฑูุงูโฺฏุฐุงุฑ ๐ค**
```
1. /start ู ุชุงุฏ ููุช
2. [๐ฐ ุณุฑูุงูโฺฏุฐุงุฑ] - ูุดุงูุฏูู ููุฌูุฏ
3. [๐ ูููุฏุงุฑ] - ุจุฑุฑุณ ฺฏุฑุงู ุฑุดุฏ
4. [๐ ฺฏุฒุงุฑุด] - ุฏุงูููุฏ ฺฏุฒุงุฑุด ูุงูุงูู
```

### **ุจุฑุง ุญุณุงุจุฏุงุฑ ๐ผ**
```
1. [โ ุชุฑุงฺฉูุด ุฌุฏุฏ] - ุซุจุช ูุงุฑุฒ/ุจุฑุฏุงุดุช
2. [๐ ุฌุณุชุฌู] - ูพุฏุง ฺฉุฑุฏู ุณุฑูุงูโฺฏุฐุงุฑ
3. [๐ ูุณุช] - ุชูุงู ุชุฑุงฺฉูุดโูุง
4. [๐พ ุตุงุฏุฑุงุช] - ุฏุงูููุฏ Excel
```

### **ุจุฑุง ุงุฏูู ๐จโ๐ผ**
```
1. [๐ ุฏุฑุขูุฏ] - ุจุฑุฑุณโฺฉุฑุฏู ุงุฑุฒุด ุฏุงุฑุง
2. [๐ฅ ฺฉุงุฑุจุฑุงู] - ูุฏุฑุช ููุดโูุง
3. [โ๏ธ ุชูุธูุงุช] - ูพฺฉุฑุจูุฏ ุณุณุชู
4. [๐ ุขูุงุฑ] - ฺฏุฒุงุฑุดโูุง ฺฉู
```

## ๐ **ุงุณุชูุงุฏูู Webhook (Production)**

### **ูุฑุญููู 1: Ngrok Setup**
```bash
bash setup_webhook_ngrok.sh
# ุฎุฑูุฌ:
# โ Ngrok URL: https://xxxx-xxxx-xxx-xxx.ngrok.io
```

### **ูุฑุญููู 2: [ุงุฎุชุงุฑ] Setup Telegram
```
ุงุฒ Bot Father:
/setwebhook
https://xxxx-xxxx-xxx-xxx.ngrok.io/webhook/telegram
```

### **ูุฑุญููู 3: ูุธุงุฑุช**
```bash
# ูุดุงูุฏูู ูุงฺฏโูุง
bash dashboard.sh

# ุง ูุจ:
http://localhost:8000
```

## ๐ **ุฑูุน ูุดฺฉูุงุช**

### **ูุดฺฉู: Bot ูพุงุณุฎ ููโุฏูุฏ**
```bash
# ุจุฑุฑุณ ูุถุนุช
ps aux | grep run_bot.py

# ูุดุงูุฏูู ูุงฺฏโูุง
tail -50 logs/bot.log

# ุดุฑูุน ุฏูุจุงุฑู
bash stop_bot.sh
sleep 2
bash start_bot.sh
```

### **ูุดฺฉู: Port 8000 ุฏุฑ ุญุงู ุงุณุชูุงุฏู**
```bash
# ูพุฏุง ฺฉุฑุฏูู ูุฑุขูุฏ
lsof -i :8000

# ุชุบุฑ ูพูุฑุช (ุฏุฑ webhook_server.py)
python3 webhook_server.py --port=8001
```

### **ูุดฺฉู: Database Lock**
```bash
# ุญุฐู ูุงู Lock
rm pishro_bot.db-wal pishro_bot.db-shm

# ุดุฑูุน ุฏูุจุงุฑู
python3 run_bot.py
```

### **ูุดฺฉู: Ngrok disconnected**
```bash
# ุฏุฑุงูุช URL ุฌุฏุฏ
bash setup_webhook_ngrok.sh

# ุชูุธู Webhook ุฌุฏุฏ
# ุงุฒ Bot Father: /setwebhook <new-url>/webhook/telegram
```

## ๐ก **ูฺฉุงุช ู ุจูุชุฑู ุฑูุดโูุง**

โ **ุจุฎุดโูุง ููุซุฑ:**
- ุงุฒ `run_servers.sh` ุจุฑุง ุดุฑูุน ุงุณุชูุงุฏู ฺฉูุฏ
- Dashboard ุฑุง ุจุงุฒ ูฺฏุงู ุฏุงุฑุฏ ุจุฑุง ูุธุงุฑุช
- ูุงฺฏโูุง ุฑุง ููุธู ุจุฑุฑุณ ฺฉูุฏ

โ๏ธ **ุงุญุชุงุท:**
- ุชูฺฉู ุจุงุช ุฑุง ุฏุฑ .env ูฺฏุงู ุฏุงุฑุฏ (Public ูฺฉูุฏ!)
- ูพูุฑุช 8000 ุฑุง ุฏุฑ Firewall ุจุงุฒ ฺฉูุฏ
- ูุงฺฏโูุง ุญุงู ุฏุงุฏูโูุง ุญุณุงุณ ุฑุง ูพุงฺฉ ฺฉูุฏ

## ๐ **ูุฑุงุฌุน ู ููุงุจุน**

- ๐ [aiogram 3.x Documentation](https://docs.aiogram.dev/en/latest/)
- ๐ [SQLAlchemy 2.0](https://docs.sqlalchemy.org/)
- ๐ [FastAPI Guide](https://fastapi.tiangolo.com/)
- ๐ [Telegram Bot API](https://core.telegram.org/bots/api)
- ๐ [Ngrok Documentation](https://ngrok.com/docs)

## ๐ **ูพุดุชุจุงู ู ุชูุงุณ**

```
๐ง ุงูู: support@pishro.ir
๐ฌ ุชูฺฏุฑุงู: @PishroBot_Support
๐ ูุจุณุงุช: https://pishro.ir
```

## ๐ **ุฏุฑุฎูุงุณุช ูฺฺฏ / ฺฏุฒุงุฑุด ุจฺฏ**

ุงฺฏุฑ ูุดฺฉู ูพุฏุง ฺฉุฑุฏุฏ ุง ูพุดููุงุฏ ุฏุงุฑุฏ:

```bash
# ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู
python3 test_bot.py
pylint app/
black app/
```

## ๐ **ุชุงุฑุฎฺูู ูุณุฎูโูุง**

```
v1.0.0 - 2025-02-24 โ STABLE
โโ ุณุณุชู ูุณุชูโุง ุฑุจุงุช
โโ ูุฏุฑุช ุณุฑูุงูโฺฏุฐุงุฑ
โโ Glass Panel UI
โโ Dashboard ูุจโูพุงูู
โโ Webhook + Ngrok Support
```

## ๐ **ูุงุณูุณ**

MIT License - ุจุจูุฏ [LICENSE](LICENSE) ุจุฑุง ุฌุฒุฆุงุช

---

**ุชูุณุนูโ ุงูุชูู ุชูุณุท:**
- ๐จโ๐ป Development Team
- ๐จ Design Team  
- ๐งช QA Team

**ุชุงุฑุฎ:** ฑดฐณ/ฑฑ/ฐด (2025-02-24)  
**ูุณุฎู:** 1.0.0  
**ูุถุนุช:** โ Production Ready
